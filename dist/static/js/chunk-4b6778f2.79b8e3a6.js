(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4b6778f2"],{"707c":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("h3",[e._v("Projects")]),a("img",{staticStyle:{width:"100%"},attrs:{src:e.API_URL+"/images/banner-project.jpg"}}),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.projects}},[a("el-table-column",{attrs:{label:"Title image",prop:"title_img"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("el-avatar",{attrs:{shape:"square",size:50,src:e.row.filepath}})]}}])}),a("el-table-column",{attrs:{label:"Title",prop:"title"}}),a("el-table-column",{attrs:{label:"Tag",prop:"tag"}}),a("el-table-column",{attrs:{label:"Location",prop:"location"}}),a("el-table-column",{attrs:{label:"Upload date",prop:"created_at"}}),a("el-table-column",{attrs:{width:"180",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return e.handleView(t.$index,t.row)}}},[a("i",{staticClass:"el-icon-view"})]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[a("i",{staticClass:"el-icon-edit"})]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[a("i",{staticClass:"el-icon-delete"})])]}}])},[a("template",{slot:"header"},[a("el-button",{attrs:{type:"success",size:"mini"},on:{click:e.handleAdd}},[a("i",{staticClass:"el-icon-plus"})])],1)],2)],1),a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogForm,width:"80%"},on:{"update:visible":function(t){e.dialogForm=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px","label-position":"top"}},[a("el-form-item",{attrs:{label:"Title"}},[a("el-input",{model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),a("el-form-item",{attrs:{label:"Title Image"}},[a("el-upload",{ref:"file",staticClass:"avatar-uploader",attrs:{action:"#","auto-upload":!1,"show-file-list":!1,"on-change":e.onFileChange,accept:"image/jpeg,image/png"}},[e.url?a("img",{staticClass:"avatar",attrs:{src:e.url}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{attrs:{label:"Tag"}},[a("el-input",{model:{value:e.form.tag,callback:function(t){e.$set(e.form,"tag",t)},expression:"form.tag"}})],1),a("el-form-item",{attrs:{label:"Location"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"Select"},model:{value:e.form.location,callback:function(t){e.$set(e.form,"location",t)},expression:"form.location"}},e._l(e.provinces,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name_en+", Thailand",value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"Owner"}},[a("el-input",{model:{value:e.form.owner,callback:function(t){e.$set(e.form,"owner",t)},expression:"form.owner"}})],1),a("el-form-item",{attrs:{label:"Consultants"}},[a("el-input",{model:{value:e.form.consultants,callback:function(t){e.$set(e.form,"consultants",t)},expression:"form.consultants"}})],1),a("el-form-item",{attrs:{label:"Year"}},[a("el-date-picker",{attrs:{type:"year",placeholder:"Start"},model:{value:e.form.start_year,callback:function(t){e.$set(e.form,"start_year",t)},expression:"form.start_year"}}),e._v(" - "),a("el-date-picker",{attrs:{type:"year",placeholder:"End"},model:{value:e.form.end_year,callback:function(t){e.$set(e.form,"end_year",t)},expression:"form.end_year"}})],1),a("el-form-item",{attrs:{label:"Project category"}},[a("el-select",{staticStyle:{width:"100%"},model:{value:e.form.category_id,callback:function(t){e.$set(e.form,"category_id",t)},expression:"form.category_id"}},e._l(e.categories,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"Detail"}},[a("wysiwyg",{model:{value:e.form.body,callback:function(t){e.$set(e.form,"body",t)},expression:"form.body"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogForm=!1}}},[e._v("Cancel")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitDialog}},[e._v("Confirm")])],1)],1),a("el-dialog",{attrs:{title:"",visible:e.dialogView,width:"80%"},on:{"update:visible":function(t){e.dialogView=t}}},[a("div",{attrs:{align:"center"}},[a("el-avatar",{attrs:{shape:"square",size:350,src:e.url}})],1),a("h3",[e._v(e._s(e.form.title))]),a("span",{domProps:{innerHTML:e._s(e.form.body)}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogView=!1}}},[e._v("Cancel")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogView=!1}}},[e._v("Confirm")])],1)])],1)},l=[],r=a("b85c"),n=a("1da1"),i=(a("96cf"),a("ac1f"),a("1276"),a("a15b"),a("b0c0"),a("a434"),a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861"),a("bc3a")),s=a.n(i),c={data:function(){return{API_URL:"localhost",search:"",form:{title:null,tag:null,location:null,owner:null,consultants:null,start_year:null,end_year:null,category_id:null,body:null},formLabelWidth:"120px",dialogForm:!1,file:null,url:"",dialogTitle:"",editIndex:-1,dialogView:!1,projects:[],categories:[],provinces:[]}},created:function(){var e=window.location.href.split("://");e[1]=e[1].split("/").shift(),e[1]=e[1].split(":").shift(),this.API_URL=e.join("://")},mounted:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,o,l,n,i,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.projects=[],t.next=3,s.a.get(e.API_URL+"/project/list");case 3:a=t.sent,o=Object(r["a"])(a.data.data);try{for(o.s();!(l=o.n()).done;)n=l.value,n.created_at=n.created_at.split("T")[0],n.filepath=e.API_URL+"/images/uploads/"+n.title_img,e.projects.push(n)}catch(d){o.e(d)}finally{o.f()}return t.next=8,s.a.get(e.API_URL+"/project_category/list");case 8:return i=t.sent,e.categories=i.data.data,t.next=12,s.a.get(e.API_URL+"/province/list");case 12:c=t.sent,e.provinces=c.data.data;case 14:case"end":return t.stop()}}),t)})))()},methods:{submitDialog:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,o,l,r,n,i,c,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.dialogForm=!1,a=null,e.form.start_year&&(a=new Date(e.form.start_year),a=a.getFullYear()),o=null,e.form.end_year&&(o=new Date(e.form.end_year),o=o.getFullYear()),l="Success",r=new FormData,r.append("title",e.form.title),r.append("tag",e.form.tag),r.append("location",e.form.location),r.append("owner",e.form.owner),r.append("consultants",e.form.consultants),r.append("start_year",a),r.append("end_year",o),r.append("category_id",e.form.category_id),r.append("body",e.form.body),!e.form.title||!e.form.body){t.next=34;break}if(n=new Date,!(e.editIndex<0)){t.next=27;break}return e.file&&r.append("file",e.file),t.next=22,s.a.post(e.API_URL+"/project/add",r);case 22:i=t.sent,i.data.data.insertId&&e.projects.push({id:i.data.data.insertId,filename:i.data.data.filename,filepath:e.API_URL+"/images/uploads/"+i.data.data.filename,title:e.form.title,tag:e.form.tag,location:e.form.location,owner:e.form.owner,consultants:e.form.consultants,start_year:e.form.start_year,end_year:e.form.end_year,category_id:e.form.category_id,body:e.form.body,created_at:n.toISOString().split("T")[0]}),l="Add project completed",t.next=34;break;case 27:return r.append("id",e.projects[e.editIndex].id),e.file&&r.append("file",e.file),t.next=31,s.a.post(e.API_URL+"/project/update",r);case 31:c=t.sent,c.data.data.affectedRows&&(e.projects[e.editIndex].title=e.form.title,e.projects[e.editIndex].tag=e.form.tag,e.projects[e.editIndex].location=e.form.location,e.projects[e.editIndex].owner=e.form.owner,e.projects[e.editIndex].consultants=e.form.consultants,e.projects[e.editIndex].start_year=e.form.start_year,e.projects[e.editIndex].end_year=e.form.end_year,e.projects[e.editIndex].category_id=e.form.category_id,e.projects[e.editIndex].body=e.form.body,e.file&&(d=e.file.name.split(".").join("-pj-"+n.getHours()+"."),e.projects[e.editIndex].filename=d,e.projects[e.editIndex].filepath=e.API_URL+"/images/uploads/"+d),e.projects[e.editIndex].created_at=n.toISOString().split("T")[0]),l="Update project completed";case 34:e.$message({type:"success",message:l}),e.dialogForm=!1;case 36:case"end":return t.stop()}}),t)})))()},handleView:function(e,t){this.dialogView=!0,this.url=t.filepath,this.form=t},handleAdd:function(){this.editIndex=-1,this.url=null,this.dialogTitle="Add project",this.dialogForm=!0,this.form={title:null,tag:null,location:null,owner:null,consultants:null,start_year:null,end_year:null,category_id:null,body:null}},handleEdit:function(e,t){this.editIndex=e,this.dialogTitle="Edit project",this.dialogForm=!0,this.file=null,this.url=t.filepath,this.form=t},handleDelete:function(e,t){var a=this;this.$confirm("Delete ?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then((function(){s.a.post(a.API_URL+"/project/remove",t),a.projects.splice(e,1),a.$message({type:"success",message:"Delete completed"})})).catch((function(){a.$message({type:"info",message:"Delete canceled"})}))},onFileChange:function(e){this.$refs.file.clearFiles(),this.file=e.raw,this.url=URL.createObjectURL(this.file)}}},d=c,f=(a("e0d3"),a("2877")),u=Object(f["a"])(d,o,l,!1,null,null,null);t["default"]=u.exports},e0d3:function(e,t,a){"use strict";a("e7f7")},e7f7:function(e,t,a){}}]);