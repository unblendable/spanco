(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ac1a1f34"],{3730:function(e,t,i){"use strict";i("f5be")},efaa:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("h3",[e._v("Services")]),i("img",{staticStyle:{width:"100%"},attrs:{src:e.API_URL+"/images/banner-service.jpg"}}),i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.services}},[i("el-table-column",{attrs:{label:"Title image",prop:"title_img"},scopedSlots:e._u([{key:"default",fn:function(e){return[i("el-avatar",{attrs:{shape:"square",size:50,src:e.row.filepath}})]}}])}),i("el-table-column",{attrs:{label:"Title",prop:"title"}}),i("el-table-column",{attrs:{label:"Upload date",prop:"created_at"}}),i("el-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(i){return e.handleView(t.$index,t.row)}}},[i("i",{staticClass:"el-icon-view"})]),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(i){return e.handleEdit(t.$index,t.row)}}},[i("i",{staticClass:"el-icon-edit"})]),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){return e.handleDelete(t.$index,t.row)}}},[i("i",{staticClass:"el-icon-delete"})])]}}])},[i("template",{slot:"header"},[i("el-button",{attrs:{type:"success",size:"mini"},on:{click:e.handleAdd}},[i("i",{staticClass:"el-icon-plus"})])],1)],2)],1),i("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogForm,width:"80%"},on:{"update:visible":function(t){e.dialogForm=t}}},[i("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px","label-position":"top"}},[i("el-form-item",{attrs:{label:"Title"}},[i("el-input",{model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),i("el-form-item",{attrs:{label:"Title Image"}},[i("el-upload",{ref:"file",staticClass:"avatar-uploader",attrs:{action:"#","auto-upload":!1,"show-file-list":!1,"on-change":e.onFileChange,accept:"image/jpeg,image/png"}},[e.url?i("img",{staticClass:"avatar",attrs:{src:e.url}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),i("el-form-item",{attrs:{label:"Detail"}},[i("wysiwyg",{model:{value:e.form.body,callback:function(t){e.$set(e.form,"body",t)},expression:"form.body"}})],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogForm=!1}}},[e._v("Cancel")]),i("el-button",{attrs:{type:"primary"},on:{click:e.submitDialog}},[e._v("Confirm")])],1)],1),i("el-dialog",{attrs:{title:"",visible:e.dialogView,width:"80%"},on:{"update:visible":function(t){e.dialogView=t}}},[i("div",{attrs:{align:"center"}},[i("el-avatar",{attrs:{shape:"square",size:350,src:e.url}})],1),i("h3",[e._v(e._s(e.form.title))]),i("span",{domProps:{innerHTML:e._s(e.form.body)}}),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogView=!1}}},[e._v("Cancel")]),i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogView=!1}}},[e._v("Confirm")])],1)])],1)},l=[],s=i("b85c"),n=i("1da1"),o=(i("96cf"),i("ac1f"),i("1276"),i("a15b"),i("b0c0"),i("a434"),i("d3b7"),i("3ca3"),i("ddb0"),i("2b3d"),i("9861"),i("bc3a")),r=i.n(o),c={data:function(){return{API_URL:"localhost",services:[],search:"",form:{title:null,body:null},formLabelWidth:"120px",dialogForm:!1,file:null,url:"",dialogTitle:"",editIndex:-1,dialogView:!1}},created:function(){var e=window.location.href.split("://");e[1]=e[1].split("/").shift(),e[1]=e[1].split(":").shift(),this.API_URL=e.join("://")},mounted:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var i,a,l,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.services=[],t.next=3,r.a.get(e.API_URL+"/service/list");case 3:i=t.sent,a=Object(s["a"])(i.data.data);try{for(a.s();!(l=a.n()).done;)n=l.value,n.created_at=n.created_at.split("T")[0],n.filepath=e.API_URL+"/images/uploads/"+n.title_img,e.services.push(n)}catch(o){a.e(o)}finally{a.f()}case 6:case"end":return t.stop()}}),t)})))()},methods:{submitDialog:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var i,a,l,s,n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.dialogForm=!1,i="Success",a=new FormData,a.append("title",e.form.title),a.append("body",e.form.body),!e.form.title||!e.form.body){t.next=23;break}if(l=new Date,!(e.editIndex<0)){t.next=16;break}return e.file&&a.append("file",e.file),t.next=11,r.a.post(e.API_URL+"/service/add",a);case 11:s=t.sent,s.data.data.insertId&&e.services.push({id:s.data.data.insertId,filename:s.data.data.filename,filepath:e.API_URL+"/images/uploads/"+s.data.data.filename,title:e.form.title,body:e.form.body,created_at:l.toISOString().split("T")[0]}),i="Add service completed",t.next=23;break;case 16:return a.append("id",e.services[e.editIndex].id),e.file&&a.append("file",e.file),t.next=20,r.a.post(e.API_URL+"/service/update",a);case 20:n=t.sent,n.data.data.affectedRows&&(e.services[e.editIndex].title=e.form.title,e.services[e.editIndex].body=e.form.body,e.file&&(o=e.file.name.split(".").join("-sv-"+l.getHours()+"."),e.services[e.editIndex].filename=o,e.services[e.editIndex].filepath=e.API_URL+"/images/uploads/"+o),e.services[e.editIndex].created_at=l.toISOString().split("T")[0]),i="Update service completed";case 23:e.$message({type:"success",message:i}),e.dialogForm=!1;case 25:case"end":return t.stop()}}),t)})))()},handleView:function(e,t){this.dialogView=!0,this.url=t.filepath,this.form.title=t.title,this.form.body=t.body,console.log(t)},handleAdd:function(){this.editIndex=-1,this.url=null,this.dialogTitle="Add service",this.dialogForm=!0,this.form={title:null,body:null,active:!0,file:null}},handleEdit:function(e,t){this.editIndex=e,this.dialogTitle="Edit service",this.dialogForm=!0,this.file=null,this.url=t.filepath,this.form={title:t.title,body:t.body}},handleDelete:function(e,t){var i=this;this.$confirm("Delete ?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then((function(){r.a.post(i.API_URL+"/service/remove",t),i.services.splice(e,1),i.$message({type:"success",message:"Delete completed"})})).catch((function(){i.$message({type:"info",message:"Delete canceled"})}))},onFileChange:function(e){this.$refs.file.clearFiles(),this.file=e.raw,this.url=URL.createObjectURL(this.file)}}},d=c,u=(i("3730"),i("2877")),f=Object(u["a"])(d,a,l,!1,null,null,null);t["default"]=f.exports},f5be:function(e,t,i){}}]);